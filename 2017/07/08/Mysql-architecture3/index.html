<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>3. Mysql 아키텍처(3.4, 3.5, 3.6) | Wonny's note</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/feed.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-102438172-1','auto');ga('send','pageview');</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">3. Mysql 아키텍처(3.4, 3.5, 3.6)</h1><a id="logo" href="/.">Wonny's note</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">3. Mysql 아키텍처(3.4, 3.5, 3.6)</h1><div class="post-meta">Jul 8, 2017<span> | </span><span class="category"><a href="/categories/Mysql/">Mysql</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><h1 id="3-4-Memory-스토리지-엔진-아키텍처"><a href="#3-4-Memory-스토리지-엔진-아키텍처" class="headerlink" title="3.4 Memory 스토리지 엔진 아키텍처"></a>3.4 Memory 스토리지 엔진 아키텍처</h1><p>Memory 스토리지 엔진은 Heap 스토리지 엔진 이라고도 하는데, 이름 그대로 데이터를 메모리에 저장하는 것이 특징이다. 데이터의 크기가 작고 아주 빠른 처리가 필요한 경우 적합한 엔진이다.</p>
<h2 id="3-4-1-주의사항"><a href="#3-4-1-주의사항" class="headerlink" title="3.4.1 주의사항"></a>3.4.1 주의사항</h2><h3 id="테이블의-최대-크기"><a href="#테이블의-최대-크기" class="headerlink" title="테이블의 최대 크기"></a>테이블의 최대 크기</h3><p>다른 스토리지 엔진을 이용한 테이블과는 달리 Memory 스토리지 엔진을 사용하는 테이블은 저장할 수 있는 데이터의 최대 용량이 정해져 있다. 최대 데이터의 크기는 max_heap_table_size 파라미터로 정의한다</p>
<h3 id="고정-길이-칼럼만-지원"><a href="#고정-길이-칼럼만-지원" class="headerlink" title="고정 길이 칼럼만 지원"></a>고정 길이 칼럼만 지원</h3><p>Memory 테이블의 모든 칼럼은 항상 고정 길이로만 생성된다. 즉 varchar(100)와 같은 타입의 칼럼을 만들어도 char(100)과 동일하게 공간이 할당된다는 의미이다. 따라서 불필요하게 너무 큰 데이터 타입을 사용하지 않는 것이 좋다.</p>
<h3 id="Blob-이나-Text와-같은-LOB-Large-Object-타입은-지원하지-않음"><a href="#Blob-이나-Text와-같은-LOB-Large-Object-타입은-지원하지-않음" class="headerlink" title="Blob 이나 Text와 같은 LOB(Large Object) 타입은 지원하지 않음"></a>Blob 이나 Text와 같은 LOB(Large Object) 타입은 지원하지 않음</h3><h3 id="Memory-테이블은-기본적으로-해시-인덱스-사용"><a href="#Memory-테이블은-기본적으로-해시-인덱스-사용" class="headerlink" title="Memory 테이블은 기본적으로 해시 인덱스 사용"></a>Memory 테이블은 기본적으로 해시 인덱스 사용</h3><p>InnoDB나 MyISAM 테이블을 생성할 때 별다른 내용을 명시하지 않으면 기본적으로 B-Tree 인덱스가 생성되지만 Memory 스토리지 엔진을 사용하면 해시 인덱스를 생성한다.</p>
<h2 id="3-4-2-용도"><a href="#3-4-2-용도" class="headerlink" title="3.4.2 용도"></a>3.4.2 용도</h2><p>Memory 스토리지는 사실 Mysql 엔진이 쿼리를 처리하는 과정에서 임시로 생성되는 임시 테이블 용도로 자주 사용된다.</p>
<h1 id="3-5-NDB-클러스터-스토리지-엔진"><a href="#3-5-NDB-클러스터-스토리지-엔진" class="headerlink" title="3.5 NDB 클러스터 스토리지 엔진"></a>3.5 NDB 클러스터 스토리지 엔진</h1><p>NDB 클러스터는 “Network DataBase” 의 줄임말로 일반적으로 NDB 라 불리운다. NDB는 데이터의 분산이나 그로인한 성능 향상 보다는 가용성에 집중된 스토리지 엔진이다. </p>
<h2 id="3-5-1-NDB-클러스터의-특성"><a href="#3-5-1-NDB-클러스터의-특성" class="headerlink" title="3.5.1 NDB 클러스터의 특성"></a>3.5.1 NDB 클러스터의 특성</h2><h3 id="무공유-클러스터링"><a href="#무공유-클러스터링" class="headerlink" title="무공유 클러스터링"></a>무공유 클러스터링</h3><p>NDB는 데이터를 저장하는 스토리지가 분산되어 관리되기 때문에 하나의 데이터 저장소가 작동을 멈추더라도 서비스에 영향을 미치지 않는다.</p>
<h3 id="메모리-기반의-스토리지-엔진"><a href="#메모리-기반의-스토리지-엔진" class="headerlink" title="메모리 기반의 스토리지 엔진"></a>메모리 기반의 스토리지 엔진</h3><p>NDB는 클러스터 노드 간의 빠른 데이터 동기화를 위해 메모리를 사용한다. NDB 클러스터는 데이터 스토리지까지 분산하기 때문에 각 노드의 물리적 메모리를 모두 합친 것이 실제 저장 가능한 최대 용량이 된다. </p>
<h3 id="자동화된-Fail-over"><a href="#자동화된-Fail-over" class="headerlink" title="자동화된 Fail-over"></a>자동화된 Fail-over</h3><p>NDB는 모든 구성 노드가 서로의 상태를 계속 체크하고 있기 때문에 특정 노드에 문제가 발생해도 다른 사용 가능한 노드가 그 역할을 이어받는 형태로 페일 오버가 가능하다.</p>
<h3 id="분산된-데이터-저장소간의-동기-방식-Sync-복제"><a href="#분산된-데이터-저장소간의-동기-방식-Sync-복제" class="headerlink" title="분산된 데이터 저장소간의 동기 방식(Sync) 복제"></a>분산된 데이터 저장소간의 동기 방식(Sync) 복제</h3><p>NDB에서 데이터 저장소는 분산되어 관리되는데, 각 데이터 저장소는 전체 데이터를 N등분해서 자신이 전담하는 파티션과 백업으로 보조 파티션을 구성한다. 각 데이터 저장소는 분산된 서로의 데이터를 동기화 해야 하는데 NDB는 비동기 방식이 아닌 동기 방식으로 서로의 데이터를 전달한다.</p>
<h3 id="온라인-스키마-변경"><a href="#온라인-스키마-변경" class="headerlink" title="온라인 스키마 변경"></a>온라인 스키마 변경</h3><p>NDB는 테이블에 칼럼이나 인덱스를 추가하면서 동시에 Insert 나 Update와 같은 DML 쿼리를 처리할 수 있다. 이를 온라인 스키마 변경이라 하는데 사용하는 방법은 Alter table 이나 Create index 명령에 Online 키워드를 사용하면 된다. Online 키워드를 사용하지 않은 스키마 변경 쿼리(DDL)은 클러스터가 온라인 처리 유무를 판단하고 가능한 경우 온라인 방식으로 처리한다.</p>
<h3 id="NoSql"><a href="#NoSql" class="headerlink" title="NoSql"></a>NoSql</h3><h3 id="네트워크-DB"><a href="#네트워크-DB" class="headerlink" title="네트워크 DB"></a>네트워크 DB</h3><p>NDB는 내부적으로 데이터를 저장하고 읽기 위해 네트워크를 기반으로 작동한다. 이는 하나의 서버에서 모든 처리가 일어나는 다른 스토리지 엔진과는 상당히 다른 개념이다</p>
<h2 id="3-5-2-NDB-클러스터의-아키텍처"><a href="#3-5-2-NDB-클러스터의-아키텍처" class="headerlink" title="3.5.2 NDB 클러스터의 아키텍처"></a>3.5.2 NDB 클러스터의 아키텍처</h2><h3 id="NDB-클러스터-노드의-종류"><a href="#NDB-클러스터-노드의-종류" class="headerlink" title="NDB 클러스터 노드의 종류"></a>NDB 클러스터 노드의 종류</h3><ul>
<li>관리노드</li>
</ul>
<p>관리노드는 실제 NDB가 정상 상태에서 서비스되는 도중에는 거의 하는 일이 없다. 관리노드는 NDB 클러스터의 전체적인 구조에 대한 정보를 다른 노드에게 전파하거나 각 노드의 장애 상황을 전파하는 역할을 담당한다.</p>
<ul>
<li>데이터 노드</li>
</ul>
<p>데이터 노드는 클러스터에 대한 전반적인 작업을 수행하는 노드다. 대표적으로는 데이터를 저장하는 스토리지를 관리하고 SQL 노드에서 오는 데이터 조작 요청을 모두 처리한다. 또한 SQL 노드가 아닌 API 노드의 요청도 처리한다. 기본적으로 데이터에 관련된 모든 요청을 데이터 노드가 처리한다고 이해하면 된다.</p>
<ul>
<li>SQL 노드</li>
</ul>
<p>NDB에 접속해 데이ㅓ를 읽고 쓰는 방법은 Mysql 서버를 통해 Sql 문법으로 처리할 수도 있지만 자바나 C 같은 프로그래밍 언어를 이용해 클러스터의 데이터를 조작할 수도 있다. 후자의 방법은 NDB API를 이용하는 방법으로 API 노드라고 표현한다. 반면 SQL서버를 이용해 NDB에 접속하는 경우를 SQL 노드라고 한다.</p>
<h3 id="데이터-노드-간의-파티션-관리"><a href="#데이터-노드-간의-파티션-관리" class="headerlink" title="데이터 노드 간의 파티션 관리"></a>데이터 노드 간의 파티션 관리</h3><p>NDB 클러스터는 데이터 노드가 손상되어도 서비스가 가능하도록 클러스터 데이터를 파티션해서 각 파티션을 최소 2개 이상의 데이터 노드에 복제해둔다. 또한 원활한 관리를 위해 데이터 노드를 노드 그룹으로 나누는데, 노드 그룹에는 반드시 1개 이상의 데이터 노드가 존재해야 하며, 노드 그룹에 속한 데이터 노드는 항상 동일한 데이터 파티션을 가진다.</p>
<h2 id="3-5-3-클러스터-간의-복제-구성"><a href="#3-5-3-클러스터-간의-복제-구성" class="headerlink" title="3.5.3 클러스터 간의 복제 구성"></a>3.5.3 클러스터 간의 복제 구성</h2><p>NDB 클러스터에도 Mysql의 복제를 적용할 수 있는데, 이런 경우는 특별히 클러스터간 복제라고 표현한다.</p>
<h2 id="3-5-6-NDB-클러스터의-용도"><a href="#3-5-6-NDB-클러스터의-용도" class="headerlink" title="3.5.6 NDB 클러스터의 용도"></a>3.5.6 NDB 클러스터의 용도</h2><p>처음에 NDB는 이동통신 사용자의 로그인 정보를 저장하는데 있었는데, 가용성이 극대화된, 소위 세션 데이터 전용 데이터베이스를 만드는 것이 목적이었다. 지금도 세션 전용 데이터베이스로 많이 사용되고 있다. </p>
<h1 id="3-6-TOKUDB-스토리지-엔진"><a href="#3-6-TOKUDB-스토리지-엔진" class="headerlink" title="3.6 TOKUDB 스토리지 엔진"></a>3.6 TOKUDB 스토리지 엔진</h1><h2 id="3-6-1-프랙탈-트리-Fractal-Tree-인덱스-지원"><a href="#3-6-1-프랙탈-트리-Fractal-Tree-인덱스-지원" class="headerlink" title="3.6.1 프랙탈 트리(Fractal Tree) 인덱스 지원"></a>3.6.1 프랙탈 트리(Fractal Tree) 인덱스 지원</h2><p>B-Tree의 경우 계속되는 Insert, Update, Delete 작업으로 인해 인덱스 페이지 내에 사용되지 못하는 공간이 생기는데 이를 단편화라고 한다. 단편화 현상에 의해 동일한 레코드건수를 조회 하더라도 디스크에서 읽어야 할 인덱스의 숫자가 많아질 수 있고, 버퍼 풀과 같은 캐시영역의 공간도 많이 차지하게 된다. 이러한 현상은 범위 검색과 같은 작업에 비효율성을 발생시킨다.</p>
<p>프랙탈 트리 인덱스는 B-Tree의 단점을 보완한 새로운 형태의 인덱싱 알고리즘이며, 이 알고리즘을 사용한 TokuDB는 프랙탈 트리의 알고리즘 개발자가 설립한 회사에서 출시한 스토리지 엔진이다.</p>
<h2 id="3-6-2-대용량-데이터와-빠른-Insert-처리"><a href="#3-6-2-대용량-데이터와-빠른-Insert-처리" class="headerlink" title="3.6.2 대용량 데이터와 빠른 Insert 처리"></a>3.6.2 대용량 데이터와 빠른 Insert 처리</h2><p>위와 같은 프랙탈 트리를 사용함으로써 인덱스에 새로운 레코드를 추가하는 작업이 상당히 빨라진다.</p>
<h2 id="3-6-3-트랜잭션-및-잠금-처리"><a href="#3-6-3-트랜잭션-및-잠금-처리" class="headerlink" title="3.6.3 트랜잭션 및 잠금 처리"></a>3.6.3 트랜잭션 및 잠금 처리</h2><h2 id="3-6-4-그-이외의-특징"><a href="#3-6-4-그-이외의-특징" class="headerlink" title="3.6.4 그 이외의 특징"></a>3.6.4 그 이외의 특징</h2><h2 id="3-6-5-TokuDB의-주-용도"><a href="#3-6-5-TokuDB의-주-용도" class="headerlink" title="3.6.5 TokuDB의 주 용도"></a>3.6.5 TokuDB의 주 용도</h2><ul>
<li>SNS 기반의 대용량 테이블(동시성을 크게 요하지 않는)</li>
<li>실시간 웹페이지 클릭 분석</li>
<li>웹 서버나 게임 서버의 로그 분석</li>
<li>고성능 웹 크롤링</li>
<li>데이터웨어 하우스</li>
</ul>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="https://jumpegg.github.io/2017/07/08/Mysql-architecture3/" data-id="cj54si0yi000474ufihbk7oj0" class="article-share-link">Share</a><div class="tags"><a href="/tags/Mysql/">Mysql</a></div><div class="post-nav"><a href="/2017/07/08/Mysql-architecture4/" class="pre">3. Mysql 아키텍처(3.7, 3.8)</a><a href="/2017/07/08/Mysql-architecture2/" class="next">3. Mysql 아키텍처(3.2, 3.3)</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mysql/">Mysql</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ionic2/">ionic2</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/문제해결/">문제해결</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/ionic2-nav/" style="font-size: 15px;">ionic2-nav</a> <a href="/tags/Mysql/" style="font-size: 15px;">Mysql</a> <a href="/tags/ionic2-menu/" style="font-size: 15px;">ionic2-menu</a> <a href="/tags/ionic-root/" style="font-size: 15px;">ionic-root</a> <a href="/tags/transection/" style="font-size: 15px;">transection</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/07/15/mysql-transection3/">CH 4 트랜잭션(4.4, 4.5)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/13/ionic-problem-01/">ionic root nav 문제해결</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/12/ionic-menu/">ionic-menu</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/12/mysql-transection2/">CH 4 트랜잭션(4.2, 4.3)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/12/mysql-transection1/">CH 4 트랜젝션(4.1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/09/Ionic-nav-guard/">Ionic Guard 구현</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/08/Mysql-architecture4/">3. Mysql 아키텍처(3.7, 3.8)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/08/Mysql-architecture3/">3. Mysql 아키텍처(3.4, 3.5, 3.6)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/08/Mysql-architecture2/">3. Mysql 아키텍처(3.2, 3.3)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/08/Mysql-architecture/">3. Mysql 아키텍쳐(3.1)</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://textshare.io" title="textshare.io" target="_blank">textshare.io</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">Wonny's note.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>